
var soundCode = {
  sdw: [
    ["斑马", "B1103001"],
    ["豹子", "B1103002"],
    ["大象", "B1103003"],
    ["公鸡", "B1103004"],
    ["狗 ",  "B1103005"],
    ["猴子", "B1103006"],
    ["老虎", "B1103007"],
    ["鹿  ", "B1103008"],
    ["驴子", "B1103009"],
    ["猫  ", "B110300A"],
    ["绵羊", "B110300B"],
    ["奶牛", "B110300C"],
    ["企鹅", "B110300D"],
    ["狮子", "B110300E"],
    ["熊猫", "B1104001"],
    ["猪  ", "B1104002"],
    ["鸭子","B1104003"],
    ["母鸡下蛋","B1104004"],
    ["鸟叫","B1104005"],
    ["鹰","B1104006"],
    ["青蛙","B1104007"],
    ["马","B1104008"],
    ["恐龙","B1104009"]
    // ["狐狸", "B1143FFF"]
  ],
  syin: [
    ["低音1", "B1105001"],
    ["低音2", "B1105002"],
    ["低音3", "B1105003"],
    ["低音4", "B1105004"],
    ["低音5", "B1105005"],
    ["低音6", "B1105006"],
    ["低音7", "B1105007"],
    ["中音1", "B1106001"],
    ["中音2", "B1106002"],
    ["中音3", "B1106003"],
    ["中音4", "B1106004"],
    ["中音5", "B1106005"],
    ["中音6", "B1106006"],
    ["中音7", "B1106007"],
    ["高音1", "B1107001"],
    ["高音2", "B1107002"],
    ["高音3", "B1107003"],
    ["高音4", "B1107004"],
    ["高音5", "B1107005"],
    ["高音6", "B1107006"],
    ["高音7", "B1107007"]
  ],
  sdh: [
    ["小猪佩奇",     "B1101001"],
    ["多啦A梦",      "B1101002"],
    ["奥特曼",       "B1101003"],
    ["美国队长",     "B1101004"],
    ["超人",         "B1101005"],
    ["秦时明月",     "B1101006"],
    ["大圣归来",     "B1101007"],
    ["白雪公主",     "B1101008"],
    ["冰雪奇缘",     "B1101009"],
    ["火影忍者",     "B110100A"],
    ["喜洋洋",       "B110100B"],
    ["小马宝莉",     "B110100C"],
    ["熊出没",       "B110100D"],
    ["粉刷匠",       "B1115004"],
    ["世上只有妈妈好","B1115006"],
    ["两只老虎",     "B1115005"],
    ["ABC字母歌",    "B1115001"],
    ["生日歌",       "B1115002"],
    ["圣诞歌",       "B1115003"],
    ["国歌",         "B1115007"],
    ["钢琴曲致爱丽丝",       "B1115008"],
    ["小跳蛙","B110200A"],
    ["小星星","B110200B"],
    ["我是一条小青龙","B110200C"],
    ["小老鼠上灯台","B110200D"],
    ["一只哈巴狗","B110200E"],
    ["你笑起来真好看","B110200F"],
    ["大风车","B1102010"],
    ["洋娃娃和小熊跳舞","B1102011"]
  ],
  sjtt:[
    ["警车","B1116001"],
    ["消防车","B1116002"],
    ["救护车","B1116003"],
    ["车辆行驶","B1116004"],
    ["按喇叭","B1116005"],
    ["火车","B1116006"],
    ["游轮","B1116007"],
    ["飞机","B1116008"],
    ["拖拉机","B1116009"],
    ["摩托车","B111600A"],
    ["注意车辆","B111600B"]
  ],
  ssh:[
    ["叮咚门铃声","B1117001"],
    ["闹钟声","B1117002"],
    ["电梯","B1117003"],
    ["掌声","B1117004"],
    ["欢迎光临","B1117005"],
    ["搅拌声","B1117006"]
  ],
  syx:[
    ["CS",      "B1102001"],
    ["QQ飞车",   "B1102002"],
    ["第五人格", "B1102003"],
    ["绝地求生", "B1102004"],
    ["王者荣耀  ", "B1102005"],
    ["消消乐", "B1102006"],
    ["英雄联盟", "B1102007"]
  ]
} ;
//水果
var imgCode = {
  ssg: [
    ["草莓", 'C101000F'],
    ["桂圆", 'C101001F'],
    ["橙子", 'C101002F'],
    ["梨",   'C101003F'],
    ["柠檬", 'C101004F'],
    ["苹果", 'C101005F'],
    ["葡萄", 'C101006F'],
    ["西瓜", 'C101007F'],
    ["香蕉", 'C101008F'],
    ["樱桃", 'C101009F']
  ],
  sjt: [
    ["跑车",     "C102009F"],
    ["坦克",     "C10200AF"],
    ["挖掘机",   "C10200BF"],
    ["邮轮",     "C10200CF"],
    ["直升飞机", "C10200DF"],
    ["吊车",     "C102000F"],
    ["帆船",     "C102001F"],
    ["飞机",     "C102002F"],
    ["公交车",   "C102003F"],
    ["滑板车",   "C102004F"],
    ["火车",     "C102005F"],
    ["货车",     "C102006F"],
    ["轿车",     "C102007F"],
    ["救护车",   "C102008F"]
  ],
  sbq: [
    ["爱心天使", "C106000F"],
    ["扎心",     "C106001F"],
    ["惊讶",     "C106002F"],
    ["礼物",     "C106003F"],
    ["狂欢",     "C106004F"],
    ["愤怒",     "C106005F"],
    ["天使",     "C106006F"],
    ["大便",     "C106007F"],
    ["老头",     "C106008F"],
    ["微笑",     "C106009F"],
    ["奔跑",     "C10600AF"],
    ["大白",     "C10600BF"],
    ["搞怪",    "C103000F"],
    ["害羞",    "C103001F"],
    ["坏笑",    "C103002F"],
    ["发呆",    "C103003F"],
    ["受伤",    "C103004F"],
    ["紧张",    "C103005F"],
    ["开心",    "C103006F"],
    ["叹号","C10600CF"],
    ["加号","C10600DF"],
    ["减号","C10600EF"],
    ["左","C10600FF"],
    ["右","C106010F"],
    ["上","C106011F"],
    ["下","C106012F"]
  ],
  sfz: [
    ["体恤",   "C10400AF"],
    ["袜子",   "C10400BF"],
    ["polo衫", "C104000F"],
    ["背心",   "C104001F"],
    ["衬衣",   "C104002F"],
    ["大衣",   "C104003F"],
    ["短裤",   "C104004F"],
    ["裤子",   "C104005F"],
    ["礼服",   "C104006F"],
    ["连帽衫", "C104007F"],
    ["连衣裙", "C104008F"],
    ["领带",   "C104009F"]
  ],
  ssw: [
    ["蛋糕",   "C105000F"],
    ["胡萝卜", "C105001F"],
    ["花椰菜", "C105002F"],
    ["鸡腿",   "C105003F"],
    ["面包",   "C105004F"],
    ["南瓜",   "C105005F"],
    ["披萨",   "C105006F"],
    ["鱼",     "C105007F"]
  ],
  snum: [
    ["A", "C108000F"],
    ["B", "C108001F"],
    ["C", "C108002F"],
    ["D", "C108003F"],
    ["E", "C108004F"],
    ["F", "C108005F"],
    ["G", "C108006F"],
    ["H", "C108007F"],
    ["I", "C108008F"],
    ["J", "C108009F"],
    ["k", "C10800AF"],
    ["L", "C10800BF"],
    ["M", "C10800CF"],
    ["N", "C10800DF"],
    ["o", "C109000F"],
    ["p", "C109001F"],
    ["Q", "C109002F"],
    ["R", "C109003F"],
    ["S", "C109004F"],
    ["T", "C109005F"],
    ["U", "C109006F"],
    ["V", "C109007F"],
    ["w", "C109008F"],
    ["X", "C109009F"],
    ["Y", "C10900AF"],
    ["Z", "C10900BF"]
  ],
  words:[
    ["bike","C10B001F"],
    ["bus","C10B002F"],
    ["car","C10B003F"],
    ["plane","C10B004F"],
    ["ship","C10B005F"],
    ["train","C10B006F"],
    ["truck","C10B007F"],
    ["barber","C10C001F"],
    ["boy","C10C002F"],
    ["daddy","C10C003F"],
    ["dancer","C10C004F"],
    ["doctor","C10C005F"],
    ["driver","C10C006F"],
    ["girl","C10C007F"],
    ["mummy","C10C008F"],
    ["nurse","C10C009F"],
    ["pupil","C10C00AF"],
    ["singer","C10C00BF"],
    ["teacher","C10C00CF"],
    ["bear","C10D001F"],
    ["cat","C10D002F"],
    ["cock","C10D003F"],
    ["dog","C10D004F"],
    ["duck","C10D005F"],
    ["hen","C10D006F"],
    ["rabbit","C10D007F"],
    ["tiger","C10D008F"],
    ["black","C10E001F"],
    ["blue","C10E002F"],
    ["brown","C10E003F"],
    ["green","C10E004F"],
    ["pink","C10E005F"],
    ["red","C10E006F"],
    ["white","C10E007F"],
    ["yellow","C10E008F"],
    ["bed","C10F001F"],
    ["bookcase","C10F002F"],
    ["cabinet","C10F003F"],
    ["chair","C10F004F"],
    ["desk","C10F005F"],
    ["sofa","C10F006F"],
    ["stool","C10F007F"],
    ["table","C10F008F"]
  ],
  sdigit:[
    ["0", "C107000F"],
    ["1", "C107001F"],
    ["2", "C107002F"],
    ["3", "C107003F"],
    ["4", "C107004F"],
    ["5", "C107005F"],
    ["6", "C107006F"],
    ["7", "C107007F"],
    ["8", "C107008F"],
    ["9", "C107009F"],
    ["10","C10700AF"],
    ["11","C10700BF"],
    ["12","C10700CF"],
    ["13","C10700DF"],
    ["14","C10700EF"],
    ["15","C10700FF"],
    ["16","C107010F"],
    ["17","C107011F"],
    ["18","C107012F"],
    ["19","C107013F"],
    ["20","C107014F"]
  ],
  hans:[
    ["一","C10A001F"],
    ["二","C10A002F"],
    ["三","C10A003F"],
    ["四","C10A004F"],
    ["五","C10A005F"],
    ["六","C10A006F"],
    ["七","C10A007F"],
    ["八","C10A008F"],
    ["九","C10A009F"],
    ["十","C10A00AF"],
    ["木","C10A00BF"],
    ["禾","C10A00CF"],
    ["上","C10A00DF"],
    ["下","C10A00EF"],
    ["土","C10A00FF"],
    ["个","C10A010F"],
    ["入","C10A011F"],
    ["大","C10A012F"],
    ["天","C10A013F"],
    ["人","C10A014F"],
    ["火","C10A015F"],
    ["文","C10A016F"],
    ["儿","C10A017F"],
    ["无","C10A018F"],
    ["口","C10A019F"],
    ["日","C10A01AF"],
    ["中","C10A01BF"],
    ["了","C10A01CF"],
    ["子","C10A01DF"],
    ["门","C10A01EF"],
    ["月","C10A01FF"],
    ["不","C10A020F"],
    ["开","C10A021F"],
    ["目","C10A022F"],
    ["耳","C10A023F"],
    ["头","C10A024F"],
    ["米","C10A025F"],
    ["见","C10A026F"],
    ["白","C10A027F"],
    ["田","C10A028F"],
    ["电","C10A029F"],
    ["也","C10A02AF"],
    ["长","C10A02BF"],
    ["山","C10A02CF"],
    ["出","C10A02DF"],
    ["飞","C10A02EF"],
    ["马","C10A02FF"],
    ["鸟","C10A030F"],
    ["云","C10A031F"],
    ["公","C10A032F"],
    ["车","C10A033F"],
    ["牛","C10A034F"],
    ["羊","C10A035F"],
    ["小","C10A036F"],
    ["少","C10A037F"],
    ["巾","C10A038F"],
    ["牙","C10A039F"],
    ["尺","C10A03AF"],
    ["毛","C10A03BF"],
    ["卜","C10A03CF"],
    ["又","C10A03DF"],
    ["心","C10A03EF"],
    ["风","C10A03FF"],
    ["力","C10A040F"],
    ["手","C10A041F"],
    ["水","C10A042F"],
    ["广","C10A043F"],
    ["升","C10A044F"],
    ["足","C10A045F"],
    ["走","C10A046F"],
    ["方","C10A047F"],
    ["半","C10A048F"],
    ["巴","C10A049F"],
    ["业","C10A04AF"],
    ["本","C10A04BF"],
    ["平","C10A04CF"],
    ["书","C10A04DF"],
    ["自","C10A04EF"],
    ["已","C10A04FF"],
    ["东","C10A050F"],
    ["西","C10A051F"],
    ["回","C10A052F"],
    ["片","C10A053F"],
    ["皮","C10A054F"],
    ["生","C10A055F"],
    ["里","C10A056F"],
    ["果","C10A057F"],
    ["几","C10A058F"],
    ["用","C10A059F"],
    ["鱼","C10A05AF"],
    ["今","C10A05BF"],
    ["正","C10A05CF"],
    ["雨","C10A05DF"],
    ["两","C10A05EF"],
    ["瓜","C10A05FF"],
    ["衣","C10A060F"],
    ["来","C10A061F"],
    ["年","C10A062F"],
    ["左","C10A063F"],
    ["右","C10A064F"]
  ]
};
//音量
var mute = [
  ["0",""]
]

function concatJSON(obj){
  var arr = [] ;
  for(var key in obj){
    arr = arr.concat(obj[key]) ;
  }
  return arr ;
}
//灯光
Blockly.defineBlocksWithJsonArray([{
    "type": "dengg1",
    "message0": "%1 颜色 %2 %3时间 %4秒",
    "args0": [{
        "type": "field_image",
        "src": "./img/deng.png",
        "width": 30,
        "height": 30
      },
      {
        "type": "field_colour",
        "name": "C",
        "colour": "#ffffff"
      },
      {
        "type": "field_image",
        "src": "./img/time.png",
        "width": 31,
        "height": 30
      },
      {
        "type": "field_dropdown",
        "name": "T",
        "otherOptions":"selectCount",
        "options": [
          ["1", "1"],
          ["2", "2"],
          ["3", "3"],
          ["4", "4"],
          ["5", "5"],
          ["6", "6"],
          ["7", "7"],
          ["8", "8"],
          ["9", "9"],
          ["10","10"]
        ]
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#FFA800"
  },
  {
    "type": "dengg2",
    "message0": "%1 颜色 %2",
    "args0": [{
        "type": "field_image",
        "src": "./img/deng.png",
        "width": 30,
        "height": 30
      },
      {
        "type": "field_colour",
        "name": "C",
        "colour": "#FFFFFF"
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#FFA800"
  },
  {
    "type": "dengg3",
    "message0": "%1 熄灭",
    "args0": [{
      "type": "field_image",
      "src": "./img/deng1.png",
      "width": 30,
      "height": 30
    }],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#FFA800"
  }
]);

//声音
Blockly.defineBlocksWithJsonArray([{
    "type": "shengy1",
    "message0": "%1 声音 %2音量 %3",
    "args0": [{
        "type": "field_image",
        "src": "./img/music.png",
        "width": 30,
        "height": 30
      },
      {
        "type": "field_dropdown",
        "name": "M",
        "otherOptions": "selectMusic",
        "options":concatJSON(soundCode)
      },
      {
        "type": "field_dropdown",
        "name": "S",
        "otherOptions":"selectCount",
        "options": [
          ["小", "1"],
          ["中", "2"],
          ["大", "3"]
        ]
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#9253E8"
  },
  {
    "type": "shengy2",
    "message0": "%1 停止",
    "args0": [{
      "type": "field_image",
      "src": "./img/music.png",
      "width": 30,
      "height": 30
    }],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#9253E8"
  }
]);

//图片
Blockly.defineBlocksWithJsonArray([{
    "type": "img1",
    "message0": "%1 图片 %2 时间 %3秒",
    "args0": [{
        "type": "field_image",
        "src": "./img/img.png",
        "width": 30,
        "height": 30
      },
      {
        "type": "field_dropdown",
        "name": "P",
        "otherOptions": "selectImg",
        "options":concatJSON(imgCode)
      },
      {
        "type": "field_dropdown",
        "name": "T",
        "otherOptions":"selectCount",
        "options": [
          ["1", "1"],
          ["2", "2"],
          ["3", "3"],
          ["4", "4"],
          ["5", "5"],
          ["6", "6"],
          ["7", "7"],
          ["8", "8"],
          ["9", "9"],
          ["10","10"]
        ]
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#16C141"
  },
  {
    "type": "img2",
    "message0": "%1 图片 %2",
    "args0": [{
        "type": "field_image",
        "src": "./img/img.png",
        "width": 30,
        "height": 30
      },
      {
        "type": "field_dropdown",
        "name": "P",
        "otherOptions": "selectImg",
        "options": concatJSON(imgCode)
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#16C141"
  },
  {
    "type": "img3",
    "message0": "%1 熄灭",
    "args0": [{
      "type": "field_image",
      "src": "./img/img.png",
      "width": 30,
      "height": 30
    }],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#16C141"
  }
]);

//电机A
Blockly.defineBlocksWithJsonArray([{
    "type": "machineA1",
    "message0": "%1 方向 %2 速度 %3 时间 %4秒",
    "args0": [{
        "type": "field_image",
        "src": "./img/a.png",
        "width": 30,
        "height": 30
      },
      {
        "type": "field_dropdown",
        "name": "D",
        "options": [
          ["↻", "0"],
          ["↺", "1"],
        ]
      },
      {
        "type": "field_dropdown",
        "name": "S",
        "otherOptions":"selectCount",
        "options": [
          ["低", "1"],
          ["中", "2"],
          ["高", "3"],
        ]
      },
      {
        "type": "field_dropdown",
        "name": "T",
        "otherOptions":"selectCount",
        "options": [
          ["1", "1"],
          ["2", "2"],
          ["3", "3"],
          ["4", "4"],
          ["5", "5"],
          ["6", "6"],
          ["7", "7"],
          ["8", "8"],
          ["9", "9"],
          ["10","10"]
        ]
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#3CA6EB"
  },
  {
    "type": "machineA2",
    "message0": "%1 方向 %2 速度 %3",
    "args0": [{
        "type": "field_image",
        "src": "./img/a.png",
        "width": 30,
        "height": 30
      },
      {
        "type": "field_dropdown",
        "name": "D",
        "options": [
          ["↻", "0"],
          ["↺", "1"],
        ]
      },
      {
        "type": "field_dropdown",
        "name": "S",
        "otherOptions":"selectCount",
        "options": [
          ["低", "1"],
          ["中", "2"],
          ["高", "3"],
        ]
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#3CA6EB"
  },
  {
    "type": "machineA3",
    "message0": "%1 停止",
    "args0": [{
      "type": "field_image",
      "src": "./img/a.png",
      "width": 30,
      "height": 30
    }],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#3CA6EB"
  }
]);
//电机B
Blockly.defineBlocksWithJsonArray([{
    "type": "machineB1",
    "message0": "%1 方向 %2 速度 %3 时间 %4秒",
    "args0": [{
        "type": "field_image",
        "src": "./img/b.png",
        "width": 30,
        "height": 30
      },
      {
        "type": "field_dropdown",
        "name": "D",
        "options": [
          ["↻", "0"],
          ["↺", "1"],
        ]
      },
      {
        "type": "field_dropdown",
        "name": "S",
        "otherOptions":"selectCount",
        "options": [
          ["低", "1"],
          ["中", "2"],
          ["高", "3"],
        ]
      },
      {
        "type": "field_dropdown",
        "name": "T",
        "otherOptions":"selectCount",
        "options": [
          ["1", "1"],
          ["2", "2"],
          ["3", "3"],
          ["4", "4"],
          ["5", "5"],
          ["6", "6"],
          ["7", "7"],
          ["8", "8"],
          ["9", "9"],
          ["10","10"]
        ]
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#00D4E1"
  },
  {
    "type": "machineB2",
    "message0": "%1 方向 %2 速度 %3",
    "args0": [{
        "type": "field_image",
        "src": "./img/b.png",
        "width": 30,
        "height": 30
      },
      {
        "type": "field_dropdown",
        "name": "D",
        "options": [
          ["↻", "0"],
          ["↺", "1"],
        ]
      },
      {
        "type": "field_dropdown",
        "name": "S",
        "otherOptions":"selectCount",
        "options": [
          ["低", "1"],
          ["中", "2"],
          ["高", "3"],
        ]
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#00D4E1"
  },
  {
    "type": "machineB3",
    "message0": "%1 停止",
    "args0": [{
      "type": "field_image",
      "src": "./img/b.png",
      "width": 30,
      "height": 30
    }],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#00D4E1"
  },
  {
    "type": "machineAB",
    "message0": "%1 %2停止",
    "args0": [{
        "type": "field_image",
        "src": "./img/a.png",
        "width": 30,
        "height": 30
      },
      {
        "type": "field_image",
        "src": "./img/b.png",
        "width": 30,
        "height": 30
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#16C141"
  }
]);
//运动
Blockly.defineBlocksWithJsonArray([{
  "type": "action0",
  "message0": "%1当开始被点击",
  "args0": [
  {
    "type": "field_image",
    "src": "./img/block.png",
    "width": 1,
    "height": 30
  }],
  "nextStatement": null,
  "colour": "#C44B98",
  "undelete": true
}]);


Blockly.defineBlocksWithJsonArray([{
    "type": "control1",
    "message0": "%1等待 %2 秒",
    "args0": [{
        "type": "field_image",
        "src": "./img/block.png",
        "width": 1,
        "height": 30
      },
      {
        "type": "field_dropdown",
        "name": "T",
        "otherOptions":"selectCount",
        "options": [
          ["1", "1"],
          ["2", "2"],
          ["3", "3"],
          ["4", "4"],
          ["5", "5"],
          ["6", "6"],
          ["7", "7"],
          ["8", "8"],
          ["9", "9"],
          ["10","10"]
        ]
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#E8504D"
  },
  {
    "type": "controls_repeat_ext",
    "message0": "%2重复执行%1次",
    "args0": [{
        "type": "field_dropdown",
        "name": "TIMES",
        "otherOptions":"selectCount",
        "options": [
          ["1", "1"],
          ["2", "2"],
          ["3", "3"],
          ["4", "4"],
          ["5", "5"],
          ["6", "6"],
          ["7", "7"],
          ["8", "8"],
          ["9", "9"],
          ["10","10"]
        ]
      },
      {
        "type": "field_image",
        "src": "./img/block.png",
        "width": 1,
        "height": 30
      }
    ],
    "message1": "%2 %1",
    "args1": [{
        "type": "input_statement",
        "name": "DO"
      },
      {
        "type": "field_image",
        "src": "./img/block.png",
        "width": 1,
        "height": 30
      }
    ],
    "previousStatement": null,
    "nextStatement": null,
    "colour": "#E8504D"
  }
]);

Blockly.JavaScript['action0'] = function(block) {
  var code = ';start();';
  return code;
};

Blockly.JavaScript['math_number'] = function(block) {
  //console.log(block)
  var code = block.getFieldValue('NUM');
  return code;
};



Blockly.JavaScript['controls_repeat'] = function(block) {
  // Do while/until loop.
  var branch = Blockly.JavaScript.statementToCode(block, 'DO');
  branch = Blockly.JavaScript.addLoopTrap(branch, block.id);
  return 'while (true) {\n' + branch + ';waitForSeconds(.2)}\n';
};

Blockly.JavaScript['controls_repeat_ext'] = function(block) {
  // Repeat n times.
  if (block.getField('TIMES')) {
    // Internal number.
    var repeats = String(Number(block.getFieldValue('TIMES')));
  } else {
    // External number.
    var repeats = Blockly.JavaScript.valueToCode(block, 'TIMES',
        Blockly.JavaScript.ORDER_ASSIGNMENT) || '0';
  }
  var branch = Blockly.JavaScript.statementToCode(block, 'DO');
  branch = Blockly.JavaScript.addLoopTrap(branch, block.id);
  var code = '';
  var loopVar = Blockly.JavaScript.variableDB_.getDistinctName(
      'count', Blockly.Variables.NAME_TYPE);
  var endVar = repeats;
  if (!repeats.match(/^\w+$/) && !Blockly.isNumber(repeats)) {
    var endVar = Blockly.JavaScript.variableDB_.getDistinctName(
        'repeat_end', Blockly.Variables.NAME_TYPE);
    code += 'var ' + endVar + ' = ' + repeats + ';\n';
  }
  code += 'for (var ' + loopVar + ' = 0; ' +
      loopVar + ' < ' + endVar + '; ' +
      loopVar + '++) {\n' +
      branch + ';waitForSeconds(.2)}\n';
  return code;
};


var dcolor = {
  "E1FFFFFF":"E1FFFFFF", 
  "E1FF0000":"E1FF0000", 
  "E1FFFF00":"E1FFFF00", 
  "E100FF00":"E100FF00", 
  "E10000FF":"E10000FF", 
  "E1A51DC0":"E1FF00FF", 
  "E1FF491C":"E1FF3200", 
  "E1FF99AC":"E1FF3C82", 
  "E158C0FF":"E100FFFF", 
  "E184FF84":"E132FF28", 
  "E19292FF":"E19696FF", 
  "E139A0FF":"E10078FF", 
  "E1A4FF23":"E196FF00", 
  "E1B04B2D":"E1FF5014", 
  "E1B844D2":"E1FF3CA0", 
  "E1EB2269":"E1FF001E", 
  "E1FF9282":"E1460000", 
  "E1FFFF82":"E1AAB400", 
  "E126C4B8":"E100FF32", 
  "E1FF9E2D":"E1FF5500"
}

Blockly.JavaScript['dengg1'] = function(block) {
  var cvalue = block.getFieldValue('C').replace("#","E1");
  var C = dcolor[cvalue.toUpperCase()] ;
  var T = Number(block.getFieldValue('T'));

  var code = 'waitForSeconds(.2);action("' +C+ '");waitForSeconds('+T+');action("E1000000");';
  return code;
};

Blockly.JavaScript['dengg2'] = function(block) {
  var cvalue = block.getFieldValue('C').replace("#","E1");
  var C = dcolor[cvalue.toUpperCase()]
  var code = ';waitForSeconds(.2);action("' +C+ '");';
  return code;
};

Blockly.JavaScript['dengg3'] = function(block) {
  var code = ';waitForSeconds(.2);action("E1000000");';
  return code;
};

Blockly.JavaScript['shengy1'] = function(block) {
  var M = block.getFieldValue('M');
  var S = block.getFieldValue('S');
  S = ['','B1214FFF','B1219FFF','B121EFFF'][S] ;
  var code = ';waitForSeconds(.2);action("'+S+'");waitForSeconds(.2);action("'+M+'");'
  return code;
};

Blockly.JavaScript['shengy2'] = function(block) {
  var code = ';waitForSeconds(.2);action("B13FFFFF");';
  return code;
};

Blockly.JavaScript['machineC'] = function(block) {
  var D = block.getFieldValue('D');
  var S = block.getFieldValue('S');
  var M = "M"+D+""+S+"FFFFF"
  var code = ';waitForSeconds(.2);action("'+M+'");';
  return code;
};


Blockly.JavaScript['img1'] = function(block) {
  var P = block.getFieldValue('P');
  var T = Number(block.getFieldValue('T'));
  var code = ';waitForSeconds(.2);action("'+P+'");waitForSeconds('+T+');action("C1FFFFFF");';
  return code;
};

Blockly.JavaScript['img2'] = function(block) {
  var P = block.getFieldValue('P');
  var code = ';waitForSeconds(.2);action("'+P+'");';
  return code;
};

Blockly.JavaScript['img3'] = function(block) {
  var code = ';waitForSeconds(.2);action("C1FFFFFF");';
  return code;
};

var machineAcode = [
    ["F10196FF","F101C8FF","F101FEFF"],
    ["F10296FF","F102C8FF","F102FEFF"]
  ] ;
Blockly.JavaScript['machineA1'] = function(block) {
  var D = Number(block.getFieldValue('D'));
  var S = Number(block.getFieldValue('S'));
  var T = Number(block.getFieldValue('T'));
  var code = ';waitForSeconds(.2);action("'+machineAcode[D][S-1]+'");waitForSeconds('+T+');action("F103FFFF");';
  return code;
};
Blockly.JavaScript['machineA2'] = function(block) {
  var D = Number(block.getFieldValue('D'));
  var S = Number(block.getFieldValue('S'));
  var code = ';waitForSeconds(.2);action("'+machineAcode[D][S-1]+'");';
  return code;
};
Blockly.JavaScript['machineA3'] = function(block) {
  var code = ';waitForSeconds(.2);action("F103FFFF");';
  return code;
};

var machineBcode = [
    ["G10196FF","G101C8FF","G101FEFF"],
    ["G10296FF","G102C8FF","G102FEFF"]
  ] ;
Blockly.JavaScript['machineB1'] = function(block) {
  var D = Number(block.getFieldValue('D'));
  var S = Number(block.getFieldValue('S'));
  var T = Number(block.getFieldValue('T'));
  var code = ';waitForSeconds(.2);action("'+machineBcode[D][S-1]+'");waitForSeconds('+T+');action("G103FFFF");';
  return code;
};
Blockly.JavaScript['machineB2'] = function(block) {
  var D = Number(block.getFieldValue('D'));
  var S = Number(block.getFieldValue('S'));
  var code = ';waitForSeconds(.2);action("'+machineBcode[D][S-1]+'");';
  return code;
};
Blockly.JavaScript['machineB3'] = function(block) {
  var code = ';waitForSeconds(.2);action("G103FFFF");';
  return code;
};

Blockly.JavaScript['machineAB'] = function(block) {
  var code = ';waitForSeconds(.2);action("A2FFFFFF");';
  return code;
};

Blockly.JavaScript['control1'] = function(block) {
  var T = Number(block.getFieldValue('T'));
  var code = ';waitForSeconds(' + T + ');';
  return code;
};

/**
 * Register the interpreter asynchronous function
 * <code>waitForSeconds()</code>.
 */
function initInterpreterWaitForSeconds(interpreter, scope) {
  // Ensure function name does not conflict with variable names.
  Blockly.JavaScript.addReservedWords('waitForSeconds');

  var wrapper = interpreter.createAsyncFunction(
    function(timeInSeconds, callback) {
      // Delay the call to the callback.
      //console.time();
      setTimeout(function(){
        //console.timeEnd();
        callback();

      }, timeInSeconds * 1000);
    });
  interpreter.setProperty(scope, 'waitForSeconds', wrapper);
}
